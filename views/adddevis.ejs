<% include header.ejs %>
<!-- =============================================== -->

<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
  <!-- Content Header (Page header) -->

  <section class="content-header">
    <h1>
      <%= title %>
      <small>Ajout de devis</small>
    </h1>
    <ol class="breadcrumb">
      <li class=""><a href="/index"><i class="fa fa-dashboard"></i> Home</a></li>
      <li class=""><a href="/devis"><i class="fa fa-dashboard"></i> liste des devis</a></li>
      <li class="active"> Ajout Devis</a></li>
    </ol>
  </section>

  <!-- Main content -->
  <section class="content">

    <!-- Default box -->
    <div class="box">
      <div class="box-header with-border">
        <h3 class="box-title">Nouveau <%= title %></h3>

      </div>
      <div class="box-body">

        <!--
        - Nature du document (Devis)
        - N°
        - Date de création
        - Prix total
        - Fournisseur
        - Numero devis fournisseur
        - Date livraison prevu
        -->

        <form class="form-horizontal" action="/devis/add" method="post">

              <!-- Box-body -->
              <!--<div class="box-body">-->
                <div class="form-group">
                  <label for="" class="col-sm-2 control-label">Nature :</label>
                  <div class="col-sm-10">
                    <input type="text" name="nature" required="required" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.nature %>">
                  </div>
                </div>

                <div class="form-group">
                  <label for="" class="col-sm-2 control-label">Numero :</label>
                  <div class="col-sm-10">
                    <input type="text" name="numero" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.numero %>">
                  </div>
                </div>



                <div class="form-group">
                  <label for="" class="col-sm-2 control-label">Date de création :</label>
                  <div class="col-sm-10">
                    <input id="datepicker" type="text" name="datecreation" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.datecreation %>">
                  </div>
                </div>



                <div class="form-group">
                  <label for="" class="col-sm-2 control-label">Date de livraison prévue :</label>
                  <div class="col-sm-10">
                    <input id="datepicker2" type="text" name="datelivraisonprevu" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.datelivraisonprevu %>">
                  </div>
                </div>



                <!-- <div class="form-group">
                  <label for="" class="col-sm-2 control-label">Prix total :</label>
                  <div class="col-sm-10">
                    <input type="text" name="prixtotal" required="required" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.prixtotal.toFixed(2); %>">
                  </div>
                </div> -->

                <div class="form-group">
                  <label class="col-sm-2 control-label">Fournisseurs :</label>
                  <div class="col-sm-10">
                      <select id="fournisseur" name="fournisseur" required="required" class="form-control select2">
                          <option value="">Selectionner un fournisseur ...</option>
                          <% for(var i=0; i<fournisseurs.length; i++){%>
                            <option value="<%= fournisseurs[i].raisonsocial + " | " + fournisseurs[i].code %>"><%= fournisseurs[i].raisonsocial %></option>
                          <%}%>
                      </select>
                  </div>
                </div>

                <div class="form-group">
                  <label for="" class="col-sm-2 control-label">N° devis fournisseur  :</label>
                  <div class="col-sm-10">
                    <input type="text" name="numerodevisfournisseur" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.numerodevisfournisseur %>">
                  </div>
                </div>



                <div class="form-group">
                  <div class="col-sm-offset-2 col-sm-10">

                  </div>
                </div>
        </div>
              <!-- /.box-body -->

      <!--</div>-->
      <!-- /.box-body -->
      <div class="box-body">
        <div id="jsGrid"></div>
      </div>





        <div class="box-footer">
            <div id="valzone" class="">
              <button id="validateOne" class="btn btn-sm btn-primary pull-right mymg" type="button" name="button">OK</button>
            </div>

            <div id="subform">
              <button type="submit" class="btn btn-sm btn-primary pull-right mymg"><i class="fa fa-fw fa-save"></i></button>
              <!-- <a href="#" class="btn btn-sm btn-primary pull-right mymg"><i class="fa fa-fw fa-save"></i></a> -->
              <a href="/devis" class="btn btn-sm btn-primary pull-right mymg">Liste des <%= title %></a>
            </div>



        </div>
      <!-- /.box-footer-->
      </form>
    </div>
    <!-- /.box -->

  </section>
  <!-- /.content -->

</div>
<!-- /.content-wrapper -->


<% include footer.ejs %>


<script >
$(document).ready(function(){
  $("#subform").css("display", "none");

  $("#validateOne").click(function(){
    document.getElementById('valzone').style.display = "none";
    document.getElementById('subform').style.display =  "";
    console.log(clients);
    clients.push({ "Name": "Ramona Benton", "Age": 32, "Country": 3, "Address": "Ap #614-689 Vehicula Street", "Married": false });

    $("#jsGrid").jsGrid({

        onItemUpdated: function(arg) {
        //console.log("row updated");
       //  console.log(tab[arg.itemIndex].prodqte);
        // $('#message').val(JSON.stringify(tab));
        },

        onItemDeleted: function(arg) {
        //console.log("row deleted");
       //  totalqte = totalqte - tab[arg.itemIndex].prodqte;
        // tab.splice(arg.itemIndex, 1);
        // $('#message').val(JSON.stringify(tab));
        },

        onItemInserted: function() {
        //console.log("row deleted");
        // $('#message').val(JSON.stringify(tab));
        }
    });


  });


 //  var sousfamille = $('#sousfamille option').clone();
 //  //  $('#sousfamille').empty();
 // $('#famille').change(function() {
 //     var val = $(this).val().split("|")[0];
 //     $('#sousfamille').empty();
 //     sousfamille.filter(function(idx, el) {
 //         return val === 'ALL' || $(el).val().indexOf(val) >= 0;
 //     }).appendTo('#sousfamille');
 // });

});
</script>


<script>
  $(function () {

    // var dt = new Date().toISOString();

    $("#datepicker").val(new Date().toISOString().substring(0,10).split("-").reverse().join("/"));
    //Date picker
    $('#datepicker').datepicker({
      autoclose: true,
      format: 'dd/mm/yyyy'
    });

    $('#datepicker2').datepicker({
      autoclose: true,
      format: 'dd/mm/yyyy'
    });


  });
</script>


<script>
    var clients = [
        { "Name": "Otto Clay", "Age": 25, "Country": 1, "Address": "Ap #897-1459 Quam Avenue", "Married": false },
        { "Name": "Connor Johnston", "Age": 45, "Country": 2, "Address": "Ap #370-4647 Dis Av.", "Married": true },
        { "Name": "Lacey Hess", "Age": 29, "Country": 3, "Address": "Ap #365-8835 Integer St.", "Married": false },
        { "Name": "Timothy Henson", "Age": 56, "Country": 1, "Address": "911-5143 Luctus Ave", "Married": true },
        { "Name": "Ramona Benton", "Age": 32, "Country": 3, "Address": "Ap #614-689 Vehicula Street", "Married": false }
    ];

    var countries = [
        { Name: "", Id: 0 },
        { Name: "United States", Id: 1 },
        { Name: "Canada", Id: 2 },
        { Name: "United Kingdom", Id: 3 }
    ];

    $("#jsGrid").jsGrid({
        width: "100%",
        height: "400px",

        inserting: true,
        editing: true,
        sorting: true,
        paging: true,

        data: clients,

        fields: [
            { name: "Name", type: "text", width: 150, validate: "required" },
            { name: "Age", type: "number", width: 50 },
            { name: "Address", type: "text", width: 200 },
            { name: "Country", type: "select", items: countries, valueField: "Id", textField: "Name" },
            { name: "Married", type: "checkbox", title: "Is Married", sorting: false },
            { type: "control" }
        ]
    });
</script>
