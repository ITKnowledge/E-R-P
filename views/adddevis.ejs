<% include header.ejs %>
<!-- =============================================== -->

<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
  <!-- Content Header (Page header) -->

  <section class="content-header">
    <h1>
      <%= title %>
      <small>Ajout de devis</small>
    </h1>
    <ol class="breadcrumb">
      <li class=""><a href="/index"><i class="fa fa-dashboard"></i> Home</a></li>
      <li class=""><a href="/devis"><i class="fa fa-dashboard"></i> liste des devis</a></li>
      <li class="active"> Ajout Devis</a></li>
    </ol>
  </section>

  <!-- Main content -->
  <section class="content">

    <!-- Default box -->
    <div class="box">
      <div class="box-header with-border">
        <h3 class="box-title">Nouveau <%= title %></h3>

      </div>
      <div class="box-body">

        <!--
        - Nature du document (Devis)
        - N°
        - Date de création
        - Prix total
        - Fournisseur
        - Numero devis fournisseur
        - Date livraison prevu
        -->

        <form class="grid-form" action="/devis/add" method="post">
            <fieldset>
              <legend>Informations sur le Devis</legend>
              <div data-row-span="4">
                <div data-field-span="1">
                  <label for="" class="control-label">Nature :</label>
                  <input type="text" name="nature" required="required" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.nature %>">
                </div>
                <div data-field-span="3">
                  <label for="" class="control-label">Numero :</label>
                  <input type="text" name="numero" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.numero %>">
                </div>
              </div>
            </fieldset>
            <fieldset>
              <div data-row-span="2">
                <div data-field-span="1">
                  <label for="" class="control-label">Date de création :</label>
                  <input id="datepicker" type="text" name="datecreation" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.datecreation %>">
                </div>
                <div data-field-span="1">
                  <label for="" class="control-label">Date de livraison prévue :</label>
                  <input id="datepicker2" type="text" name="datelivraisonprevu" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.datelivraisonprevu %>">
                </div>
            </div>
          </fieldset>
          <fieldset>
            <!-- <legend>Informations fournisseur</legend> -->
            <div data-row-span="2">
              <div data-field-span="1">
                <label class="col-sm control-label">Fournisseurs :</label>
                <select id="fournisseur" name="fournisseur" required="required" class="form-control select2">
                    <option value="">Selectionner un fournisseur ...</option>
                    <% for(var i=0; i<fournisseurs.length; i++){%>
                      <option value="<%= fournisseurs[i].raisonsocial + " | " + fournisseurs[i].code %>"><%= fournisseurs[i].raisonsocial %></option>
                    <%}%>
                </select>
              </div>
              <div data-field-span="1">
                <label for="" class="control-label">N° devis fournisseur  :</label>
                <input type="text" name="numerodevisfournisseur" class="form-control" id="" placeholder="" value="<%= devis == null ? "":devis.numerodevisfournisseur %>">
              </div>
            </div>
          </fieldset>




              <!-- <div class="col-md-12">
                <button id="ok" class="btn btn-sm btn-primary pull-right mymg col-md-12" type="button" name="button">Valider</button>
              </div> -->




        </div>
              <!-- /.box-body -->

      <!--</div>-->
      <!-- /.box-body -->
      <!-- <div class="box-header with-border">
        <h3 class="box-title">Detail <%= title %></h3>

      </div> -->

      <!-- <div class="col-md">
        <label for="code-art">Code article :</label>
        <input name="code-art" type="text" class="col-sm">
        <label for="designation">Designation article :</label>
        <input name="designation" type="text" class="col-sm">
        <label for="prix-unit">Prix Unitaire :</label>
        <input name="prix-unit" type="text" class="col-sm">
        <label for="quantite">Quantite :</label>
        <input name="quantite" type="text" class="col-sm">
        <label for="montant">Montant :</label>
        <input name="montant" type="text" class="col-sm">


      </div> -->

      <div class="box-body">
        <div id="jsGrid"></div>
      </div>





        <div class="box-footer">
            <!-- <div id="valzone" class="">
              <button id="validateOne" class="btn btn-sm btn-primary pull-right mymg" type="button" name="button">OK</button>
            </div> -->

            <div id="subform">
              <button type="submit" class="btn btn-sm btn-primary pull-right mymg"><i class="fa fa-fw fa-save"></i></button>
              <!-- <a href="#" class="btn btn-sm btn-primary pull-right mymg"><i class="fa fa-fw fa-save"></i></a> -->
              <a href="/devis" class="btn btn-sm btn-primary pull-right mymg">Liste des <%= title %></a>
            </div>



        </div>
      <!-- /.box-footer-->
      </form>
    </div>
    <!-- /.box -->

  </section>
  <!-- /.content -->




</div>
<!-- /.content-wrapper -->


<% include footer.ejs %>


<script >
$(document).ready(function(){
  $("#fournisseur").select2({
      placeholder: "Select a state",
      allowClear: true
  });
  // $("#subform").css("display", "none");

  // $("#validateOne").click(function(){
  //   document.getElementById('valzone').style.display = "none";
  //   document.getElementById('subform').style.display =  "";
  //   console.log(clients);
  //   clients.push({ "Name": "Ramona Benton", "Age": 32, "Country": 3, "Address": "Ap #614-689 Vehicula Street", "Married": false });
  //
  //   $("#jsGrid").jsGrid({
  //
  //       onItemUpdated: function(arg) {
  //       //console.log("row updated");
  //      //  console.log(tab[arg.itemIndex].prodqte);
  //       // $('#message').val(JSON.stringify(tab));
  //       },
  //
  //       onItemDeleted: function(arg) {
  //       //console.log("row deleted");
  //      //  totalqte = totalqte - tab[arg.itemIndex].prodqte;
  //       // tab.splice(arg.itemIndex, 1);
  //       // $('#message').val(JSON.stringify(tab));
  //       },
  //
  //       onItemInserted: function() {
  //       //console.log("row deleted");
  //       // $('#message').val(JSON.stringify(tab));
  //       }
  //   });
  //
  //
  // });


 //  var sousfamille = $('#sousfamille option').clone();
 //  //  $('#sousfamille').empty();
 // $('#famille').change(function() {
 //     var val = $(this).val().split("|")[0];
 //     $('#sousfamille').empty();
 //     sousfamille.filter(function(idx, el) {
 //         return val === 'ALL' || $(el).val().indexOf(val) >= 0;
 //     }).appendTo('#sousfamille');
 // });

});
</script>


<script>
  $(function () {

    // var dt = new Date().toISOString();

    $("#datepicker").val(new Date().toISOString().substring(0,10).split("-").reverse().join("/"));
    //Date picker
    $('#datepicker').datepicker({
      autoclose: true,
      format: 'dd/mm/yyyy'
    });

    $('#datepicker2').datepicker({
      autoclose: true,
      format: 'dd/mm/yyyy'
    });


  });
</script>


<script>
    var clients = [
        // { "Name": "Otto Clay", "Age": 25, "Country": 1, "Address": "Ap #897-1459 Quam Avenue", "Married": false },
        // { "Name": "Connor Johnston", "Age": 45, "Country": 2, "Address": "Ap #370-4647 Dis Av.", "Married": true },
        // { "Name": "Lacey Hess", "Age": 29, "Country": 3, "Address": "Ap #365-8835 Integer St.", "Married": false },
        // { "Name": "Timothy Henson", "Age": 56, "Country": 1, "Address": "911-5143 Luctus Ave", "Married": true },
        // { "Name": "Ramona Benton", "Age": 32, "Country": 3, "Address": "Ap #614-689 Vehicula Street", "Married": false }
    ];

    var countries = [
        { Name: "", Id: 0 },
        { Name: "United States", Id: 1 },
        { Name: "Canada", Id: 2 },
        { Name: "United Kingdom", Id: 3 }
    ];

    $("#jsGrid").jsGrid({
        width: "100%",
        height: "400px",

        inserting: true,
        editing: true,
        sorting: true,
        paging: true,

        data: clients,

        fields: [
            { name: "Code article", type: "text", width: 50, validate: "required" },
            { name: "Désignation article", type: "text", width: 200 },
            { name: "Prix unitaire", type: "number", width: 50 },
            { name: "Quantité", type: "number", width: 50 },
            { name: "Montant HT", type: "number", width: 50 },
            { type: "control" }
        ]
    });
</script>
